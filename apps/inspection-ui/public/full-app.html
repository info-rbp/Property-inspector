<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Remote Business Partner - Property Inspection Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/idb@8.0.0/build/umd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-in {
            animation: fadeIn 0.5s ease-out;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // Utility functions
        const generateId = () => Math.random().toString(36).substring(2, 15);
        
        const ROOM_TYPES = [
            'Living Room', 'Bedroom', 'Master Bedroom', 'Kitchen', 'Bathroom', 
            'Ensuite', 'Laundry', 'Garage', 'Front Yard', 'Back Yard', 
            'Hallway', 'Dining Room', 'Study', 'Entry', 'Balcony', 'Storage'
        ];
        
        const getInitialItemsForRoom = (roomType) => {
            const commonItems = [
                { name: 'Walls', isClean: true, isUndamaged: true, isWorking: true },
                { name: 'Ceiling', isClean: true, isUndamaged: true, isWorking: true },
                { name: 'Flooring', isClean: true, isUndamaged: true, isWorking: true },
                { name: 'Windows', isClean: true, isUndamaged: true, isWorking: true },
                { name: 'Light Fittings', isClean: true, isUndamaged: true, isWorking: true },
                { name: 'Power Points', isClean: true, isUndamaged: true, isWorking: true }
            ];
            
            const roomSpecific = {
                'Kitchen': [
                    { name: 'Kitchen Benchtop', isClean: true, isUndamaged: true, isWorking: true },
                    { name: 'Sink/Taps', isClean: true, isUndamaged: true, isWorking: true },
                    { name: 'Oven/Stove', isClean: true, isUndamaged: true, isWorking: true },
                    { name: 'Rangehood', isClean: true, isUndamaged: true, isWorking: true },
                    { name: 'Cupboards/Drawers', isClean: true, isUndamaged: true, isWorking: true }
                ],
                'Bathroom': [
                    { name: 'Shower', isClean: true, isUndamaged: true, isWorking: true },
                    { name: 'Toilet', isClean: true, isUndamaged: true, isWorking: true },
                    { name: 'Vanity', isClean: true, isUndamaged: true, isWorking: true },
                    { name: 'Mirror', isClean: true, isUndamaged: true, isWorking: true },
                    { name: 'Towel Rails', isClean: true, isUndamaged: true, isWorking: true }
                ],
                'Laundry': [
                    { name: 'Sink/Taps', isClean: true, isUndamaged: true, isWorking: true },
                    { name: 'Cabinets', isClean: true, isUndamaged: true, isWorking: true },
                    { name: 'Washing Machine Taps', isClean: true, isUndamaged: true, isWorking: true }
                ]
            };
            
            return [
                ...commonItems,
                ...(roomSpecific[roomType] || [])
            ].map(item => ({
                id: generateId(),
                ...item,
                comment: ''
            }));
        };

        // ConditionReport Component
        const ConditionReport = ({ reportType = 'Entry' }) => {
            const [report, setReport] = useState({
                id: generateId(),
                propertyAddress: '',
                agentName: 'Admin Team',
                agentCompany: 'Remote Business Partner',
                agentAddress: 'Perth, WA',
                agentPhone: '0400 000 000',
                agentEmail: 'admin@rbp.com.au',
                clientName: '',
                inspectionDate: new Date().toISOString().split('T')[0],
                tenantName: '',
                reportType: `${reportType} Condition Report`,
                rooms: []
            });
            
            const [selectedRoomType, setSelectedRoomType] = useState(ROOM_TYPES[0]);
            const [newRoomName, setNewRoomName] = useState(ROOM_TYPES[0]);
            const [isSaving, setIsSaving] = useState(false);
            const [savedReports, setSavedReports] = useState([]);
            const [showLoadModal, setShowLoadModal] = useState(false);
            const [isAnalyzing, setIsAnalyzing] = useState(false);
            
            const updateReport = (updates) => {
                setReport(prev => ({ ...prev, ...updates }));
            };
            
            const addRoom = () => {
                const room = {
                    id: generateId(),
                    name: newRoomName || selectedRoomType,
                    items: getInitialItemsForRoom(selectedRoomType),
                    photos: [],
                    overallComment: ''
                };
                
                setReport(prev => ({
                    ...prev,
                    rooms: [...prev.rooms, room]
                }));
            };
            
            const removeRoom = (roomId) => {
                if (confirm('Are you sure you want to remove this room?')) {
                    setReport(prev => ({
                        ...prev,
                        rooms: prev.rooms.filter(r => r.id !== roomId)
                    }));
                }
            };
            
            const handlePhotoUpload = async (roomId, files) => {
                const room = report.rooms.find(r => r.id === roomId);
                if (!room) return;
                
                const newPhotos = [];
                for (const file of files) {
                    const photo = {
                        id: generateId(),
                        file: file,
                        previewUrl: URL.createObjectURL(file),
                        tags: []
                    };
                    newPhotos.push(photo);
                }
                
                const updatedRoom = {
                    ...room,
                    photos: [...room.photos, ...newPhotos]
                };
                
                setReport(prev => ({
                    ...prev,
                    rooms: prev.rooms.map(r => r.id === roomId ? updatedRoom : r)
                }));
                
                // Analyze photos with Gemini if available
                if (newPhotos.length > 0) {
                    analyzePhotosWithAI(roomId, newPhotos, room.name);
                }
            };
            
            const analyzePhotosWithAI = async (roomId, photos, roomName) => {
                setIsAnalyzing(true);
                try {
                    for (const photo of photos) {
                        const base64 = await convertToBase64(photo.file);
                        
                        const response = await fetch('/api/gemini/analyze', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                prompt: `Analyze this ${roomName} photo for a property condition report. Identify:
                                1. Overall condition (Excellent/Good/Fair/Poor)
                                2. Any visible defects, damage, or wear
                                3. Cleanliness issues
                                4. Items that may need repair or attention
                                Use Australian English spelling. Be concise but thorough.`,
                                images: [{
                                    data: base64.split(',')[1],
                                    mimeType: photo.file.type
                                }]
                            })
                        });
                        
                        if (response.ok) {
                            const result = await response.json();
                            // Update room comment with AI analysis
                            const room = report.rooms.find(r => r.id === roomId);
                            if (room) {
                                const updatedRoom = {
                                    ...room,
                                    overallComment: room.overallComment 
                                        ? `${room.overallComment}\n\nAI Analysis: ${result.text}`
                                        : `AI Analysis: ${result.text}`
                                };
                                setReport(prev => ({
                                    ...prev,
                                    rooms: prev.rooms.map(r => r.id === roomId ? updatedRoom : r)
                                }));
                            }
                        }
                    }
                } catch (error) {
                    console.error('AI analysis failed:', error);
                } finally {
                    setIsAnalyzing(false);
                }
            };
            
            const convertToBase64 = (file) => {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = () => resolve(reader.result);
                    reader.onerror = reject;
                });
            };
            
            const saveReport = async () => {
                if (!report.propertyAddress) {
                    alert('Please enter a property address');
                    return;
                }
                
                setIsSaving(true);
                try {
                    const response = await fetch('/api/reports/save', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(report)
                    });
                    
                    if (response.ok) {
                        alert('Report saved successfully!');
                    } else {
                        throw new Error('Failed to save');
                    }
                } catch (error) {
                    alert('Failed to save report: ' + error.message);
                } finally {
                    setIsSaving(false);
                }
            };
            
            const loadReports = async () => {
                try {
                    const response = await fetch('/api/reports');
                    if (response.ok) {
                        const reports = await response.json();
                        setSavedReports(reports.filter(r => r.reportType && r.reportType.includes(reportType)));
                        setShowLoadModal(true);
                    }
                } catch (error) {
                    console.error('Failed to load reports:', error);
                }
            };
            
            return (
                <div className="max-w-7xl mx-auto p-4 animate-in">
                    <div className="bg-white rounded-lg shadow p-6 mb-6">
                        <h1 className="text-2xl font-bold text-gray-800 mb-2">
                            {reportType} Condition Report
                        </h1>
                        <p className="text-gray-600">Create a comprehensive property condition report with AI assistance</p>
                    </div>
                    
                    <div className="bg-white rounded-lg shadow p-6 mb-6">
                        <h2 className="text-xl font-semibold mb-4">Property Details</h2>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">
                                    Property Address *
                                </label>
                                <input
                                    type="text"
                                    value={report.propertyAddress}
                                    onChange={(e) => updateReport({ propertyAddress: e.target.value })}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="123 Main St, City, State"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">
                                    Client/Owner Name
                                </label>
                                <input
                                    type="text"
                                    value={report.clientName}
                                    onChange={(e) => updateReport({ clientName: e.target.value })}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">
                                    Tenant Name
                                </label>
                                <input
                                    type="text"
                                    value={report.tenantName}
                                    onChange={(e) => updateReport({ tenantName: e.target.value })}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">
                                    Inspection Date
                                </label>
                                <input
                                    type="date"
                                    value={report.inspectionDate}
                                    onChange={(e) => updateReport({ inspectionDate: e.target.value })}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                />
                            </div>
                        </div>
                    </div>
                    
                    <div className="bg-white rounded-lg shadow p-6 mb-6">
                        <h2 className="text-xl font-semibold mb-4">Add Room</h2>
                        <div className="flex gap-4">
                            <select
                                value={selectedRoomType}
                                onChange={(e) => {
                                    setSelectedRoomType(e.target.value);
                                    setNewRoomName(e.target.value);
                                }}
                                className="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            >
                                {ROOM_TYPES.map(type => (
                                    <option key={type} value={type}>{type}</option>
                                ))}
                            </select>
                            <input
                                type="text"
                                value={newRoomName}
                                onChange={(e) => setNewRoomName(e.target.value)}
                                className="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                placeholder="Room name (optional)"
                            />
                            <button
                                onClick={addRoom}
                                className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition"
                            >
                                <i className="fas fa-plus mr-2"></i>
                                Add Room
                            </button>
                        </div>
                    </div>
                    
                    {report.rooms.map(room => (
                        <div key={room.id} className="bg-white rounded-lg shadow p-6 mb-6">
                            <div className="flex justify-between items-center mb-4">
                                <h3 className="text-lg font-semibold">{room.name}</h3>
                                <button
                                    onClick={() => removeRoom(room.id)}
                                    className="text-red-600 hover:text-red-800"
                                >
                                    <i className="fas fa-trash"></i>
                                </button>
                            </div>
                            
                            <div className="mb-4">
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Photos ({room.photos.length})
                                </label>
                                <input
                                    type="file"
                                    multiple
                                    accept="image/*"
                                    onChange={(e) => handlePhotoUpload(room.id, Array.from(e.target.files))}
                                    className="hidden"
                                    id={`photo-${room.id}`}
                                />
                                <label
                                    htmlFor={`photo-${room.id}`}
                                    className="inline-block px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 cursor-pointer transition"
                                >
                                    <i className="fas fa-camera mr-2"></i>
                                    Add Photos
                                </label>
                                
                                {room.photos.length > 0 && (
                                    <div className="flex gap-2 mt-2 flex-wrap">
                                        {room.photos.map(photo => (
                                            <img
                                                key={photo.id}
                                                src={photo.previewUrl}
                                                alt="Room photo"
                                                className="w-20 h-20 object-cover rounded"
                                            />
                                        ))}
                                    </div>
                                )}
                            </div>
                            
                            {room.overallComment && (
                                <div className="mb-4 p-3 bg-blue-50 rounded-lg">
                                    <label className="block text-sm font-medium text-gray-700 mb-1">
                                        AI Analysis & Comments
                                    </label>
                                    <p className="text-sm text-gray-700 whitespace-pre-wrap">{room.overallComment}</p>
                                </div>
                            )}
                            
                            <div className="space-y-2">
                                {room.items.map(item => (
                                    <div key={item.id} className="flex items-center gap-4 p-2 bg-gray-50 rounded">
                                        <span className="flex-1 font-medium">{item.name}</span>
                                        <label className="flex items-center">
                                            <input
                                                type="checkbox"
                                                checked={item.isClean}
                                                onChange={(e) => {
                                                    const updatedRoom = {
                                                        ...room,
                                                        items: room.items.map(i =>
                                                            i.id === item.id ? { ...i, isClean: e.target.checked } : i
                                                        )
                                                    };
                                                    setReport(prev => ({
                                                        ...prev,
                                                        rooms: prev.rooms.map(r => r.id === room.id ? updatedRoom : r)
                                                    }));
                                                }}
                                                className="mr-1"
                                            />
                                            Clean
                                        </label>
                                        <label className="flex items-center">
                                            <input
                                                type="checkbox"
                                                checked={item.isUndamaged}
                                                onChange={(e) => {
                                                    const updatedRoom = {
                                                        ...room,
                                                        items: room.items.map(i =>
                                                            i.id === item.id ? { ...i, isUndamaged: e.target.checked } : i
                                                        )
                                                    };
                                                    setReport(prev => ({
                                                        ...prev,
                                                        rooms: prev.rooms.map(r => r.id === room.id ? updatedRoom : r)
                                                    }));
                                                }}
                                                className="mr-1"
                                            />
                                            Undamaged
                                        </label>
                                        <label className="flex items-center">
                                            <input
                                                type="checkbox"
                                                checked={item.isWorking}
                                                onChange={(e) => {
                                                    const updatedRoom = {
                                                        ...room,
                                                        items: room.items.map(i =>
                                                            i.id === item.id ? { ...i, isWorking: e.target.checked } : i
                                                        )
                                                    };
                                                    setReport(prev => ({
                                                        ...prev,
                                                        rooms: prev.rooms.map(r => r.id === room.id ? updatedRoom : r)
                                                    }));
                                                }}
                                                className="mr-1"
                                            />
                                            Working
                                        </label>
                                    </div>
                                ))}
                            </div>
                        </div>
                    ))}
                    
                    <div className="bg-white rounded-lg shadow p-6">
                        <div className="flex gap-4">
                            <button
                                onClick={saveReport}
                                disabled={isSaving}
                                className="px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition disabled:opacity-50"
                            >
                                {isSaving ? (
                                    <>
                                        <i className="fas fa-spinner fa-spin mr-2"></i>
                                        Saving...
                                    </>
                                ) : (
                                    <>
                                        <i className="fas fa-save mr-2"></i>
                                        Save Report
                                    </>
                                )}
                            </button>
                            <button
                                onClick={loadReports}
                                className="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition"
                            >
                                <i className="fas fa-folder-open mr-2"></i>
                                Load Report
                            </button>
                            <button
                                className="px-6 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition"
                            >
                                <i className="fas fa-file-pdf mr-2"></i>
                                Export PDF
                            </button>
                            {isAnalyzing && (
                                <div className="flex items-center text-blue-600">
                                    <i className="fas fa-robot fa-spin mr-2"></i>
                                    AI Analyzing Photos...
                                </div>
                            )}
                        </div>
                    </div>
                    
                    {showLoadModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white rounded-lg p-6 max-w-2xl w-full max-h-96 overflow-y-auto">
                                <h2 className="text-xl font-semibold mb-4">Load {reportType} Report</h2>
                                <div className="space-y-2">
                                    {savedReports.map(r => (
                                        <div
                                            key={r.id}
                                            className="p-3 bg-gray-50 rounded hover:bg-gray-100 cursor-pointer"
                                            onClick={async () => {
                                                const response = await fetch(`/api/reports/${r.id}`);
                                                if (response.ok) {
                                                    const loadedReport = await response.json();
                                                    setReport(loadedReport);
                                                    setShowLoadModal(false);
                                                }
                                            }}
                                        >
                                            <div className="font-medium">{r.propertyAddress || 'Untitled'}</div>
                                            <div className="text-sm text-gray-600">{r.inspectionDate}</div>
                                        </div>
                                    ))}
                                </div>
                                <button
                                    onClick={() => setShowLoadModal(false)}
                                    className="mt-4 px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400"
                                >
                                    Cancel
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // ClientManager Component
        const ClientManager = () => {
            const [properties, setProperties] = useState([]);
            const [showAddModal, setShowAddModal] = useState(false);
            const [newProperty, setNewProperty] = useState({
                address: '',
                owner: '',
                tenant: '',
                type: 'House',
                bedrooms: '',
                bathrooms: '',
                managementFee: ''
            });

            useEffect(() => {
                loadProperties();
            }, []);

            const loadProperties = async () => {
                // In a real app, this would load from the API
                const savedProps = localStorage.getItem('properties');
                if (savedProps) {
                    setProperties(JSON.parse(savedProps));
                }
            };

            const saveProperty = () => {
                if (!newProperty.address) {
                    alert('Please enter property address');
                    return;
                }
                const property = {
                    ...newProperty,
                    id: generateId(),
                    createdAt: new Date().toISOString()
                };
                const updatedProperties = [...properties, property];
                setProperties(updatedProperties);
                localStorage.setItem('properties', JSON.stringify(updatedProperties));
                setNewProperty({
                    address: '',
                    owner: '',
                    tenant: '',
                    type: 'House',
                    bedrooms: '',
                    bathrooms: '',
                    managementFee: ''
                });
                setShowAddModal(false);
            };

            return (
                <div className="max-w-7xl mx-auto p-4 animate-in">
                    <div className="bg-white rounded-lg shadow p-6 mb-6">
                        <div className="flex justify-between items-center">
                            <div>
                                <h1 className="text-2xl font-bold text-gray-800 mb-2">Property Management</h1>
                                <p className="text-gray-600">Manage your property portfolio</p>
                            </div>
                            <button
                                onClick={() => setShowAddModal(true)}
                                className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition"
                            >
                                <i className="fas fa-plus mr-2"></i>
                                Add Property
                            </button>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {properties.map(property => (
                            <div key={property.id} className="bg-white rounded-lg shadow p-6">
                                <h3 className="font-bold text-lg mb-2">{property.address}</h3>
                                <div className="space-y-1 text-sm text-gray-600">
                                    <p><span className="font-medium">Owner:</span> {property.owner}</p>
                                    <p><span className="font-medium">Tenant:</span> {property.tenant || 'Vacant'}</p>
                                    <p><span className="font-medium">Type:</span> {property.type}</p>
                                    <p><span className="font-medium">Beds/Baths:</span> {property.bedrooms}/{property.bathrooms}</p>
                                    <p><span className="font-medium">Management Fee:</span> ${property.managementFee}/month</p>
                                </div>
                                <div className="mt-4 flex gap-2">
                                    <button className="text-blue-600 hover:text-blue-800 text-sm">
                                        <i className="fas fa-edit mr-1"></i>Edit
                                    </button>
                                    <button className="text-red-600 hover:text-red-800 text-sm">
                                        <i className="fas fa-trash mr-1"></i>Delete
                                    </button>
                                </div>
                            </div>
                        ))}
                    </div>

                    {showAddModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white rounded-lg p-6 max-w-md w-full">
                                <h2 className="text-xl font-semibold mb-4">Add New Property</h2>
                                <div className="space-y-4">
                                    <input
                                        type="text"
                                        placeholder="Property Address"
                                        value={newProperty.address}
                                        onChange={(e) => setNewProperty({...newProperty, address: e.target.value})}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                    />
                                    <input
                                        type="text"
                                        placeholder="Owner Name"
                                        value={newProperty.owner}
                                        onChange={(e) => setNewProperty({...newProperty, owner: e.target.value})}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                    />
                                    <input
                                        type="text"
                                        placeholder="Tenant Name (optional)"
                                        value={newProperty.tenant}
                                        onChange={(e) => setNewProperty({...newProperty, tenant: e.target.value})}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                    />
                                    <select
                                        value={newProperty.type}
                                        onChange={(e) => setNewProperty({...newProperty, type: e.target.value})}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                    >
                                        <option value="House">House</option>
                                        <option value="Apartment">Apartment</option>
                                        <option value="Townhouse">Townhouse</option>
                                        <option value="Villa">Villa</option>
                                    </select>
                                    <div className="grid grid-cols-2 gap-4">
                                        <input
                                            type="number"
                                            placeholder="Bedrooms"
                                            value={newProperty.bedrooms}
                                            onChange={(e) => setNewProperty({...newProperty, bedrooms: e.target.value})}
                                            className="px-3 py-2 border border-gray-300 rounded-md"
                                        />
                                        <input
                                            type="number"
                                            placeholder="Bathrooms"
                                            value={newProperty.bathrooms}
                                            onChange={(e) => setNewProperty({...newProperty, bathrooms: e.target.value})}
                                            className="px-3 py-2 border border-gray-300 rounded-md"
                                        />
                                    </div>
                                    <input
                                        type="number"
                                        placeholder="Management Fee (per month)"
                                        value={newProperty.managementFee}
                                        onChange={(e) => setNewProperty({...newProperty, managementFee: e.target.value})}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                    />
                                </div>
                                <div className="mt-6 flex gap-4">
                                    <button
                                        onClick={saveProperty}
                                        className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
                                    >
                                        Save Property
                                    </button>
                                    <button
                                        onClick={() => setShowAddModal(false)}
                                        className="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Settings Component
        const Settings = () => {
            const [settings, setSettings] = useState({
                companyName: 'Remote Business Partner',
                agentName: 'Admin Team',
                agentEmail: 'admin@rbp.com.au',
                agentPhone: '0400 000 000',
                agentAddress: 'Perth, WA',
                geminiApiKey: ''
            });

            const saveSettings = () => {
                localStorage.setItem('appSettings', JSON.stringify(settings));
                alert('Settings saved successfully!');
            };

            useEffect(() => {
                const saved = localStorage.getItem('appSettings');
                if (saved) {
                    setSettings(JSON.parse(saved));
                }
            }, []);

            return (
                <div className="max-w-4xl mx-auto p-4 animate-in">
                    <div className="bg-white rounded-lg shadow p-6 mb-6">
                        <h1 className="text-2xl font-bold text-gray-800 mb-2">Settings</h1>
                        <p className="text-gray-600">Configure your application settings</p>
                    </div>

                    <div className="bg-white rounded-lg shadow p-6">
                        <h2 className="text-xl font-semibold mb-4">Company Information</h2>
                        <div className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Company Name</label>
                                <input
                                    type="text"
                                    value={settings.companyName}
                                    onChange={(e) => setSettings({...settings, companyName: e.target.value})}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Agent Name</label>
                                <input
                                    type="text"
                                    value={settings.agentName}
                                    onChange={(e) => setSettings({...settings, agentName: e.target.value})}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                <input
                                    type="email"
                                    value={settings.agentEmail}
                                    onChange={(e) => setSettings({...settings, agentEmail: e.target.value})}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                                <input
                                    type="text"
                                    value={settings.agentPhone}
                                    onChange={(e) => setSettings({...settings, agentPhone: e.target.value})}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Address</label>
                                <input
                                    type="text"
                                    value={settings.agentAddress}
                                    onChange={(e) => setSettings({...settings, agentAddress: e.target.value})}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                />
                            </div>
                            <button
                                onClick={saveSettings}
                                className="px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700"
                            >
                                <i className="fas fa-save mr-2"></i>
                                Save Settings
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // Main App Component with Dashboard
        const App = () => {
            const [activeTool, setActiveTool] = useState('dashboard');
            const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);

            const getActiveComponent = () => {
                switch (activeTool) {
                    case 'condition-report':
                        return <ConditionReport key="entry" reportType="Entry" />;
                    case 'routine-inspection':
                        return <ConditionReport key="routine" reportType="Routine" />;
                    case 'exit-inspection':
                        return <ConditionReport key="exit" reportType="Exit" />;
                    case 'clients':
                        return <ClientManager />;
                    case 'settings':
                        return <Settings />;
                    default:
                        return null;
                }
            };

            const NavButton = ({ tool, icon, label }) => (
                <button 
                    onClick={() => { setActiveTool(tool); setIsMobileMenuOpen(false); }}
                    className={`text-sm font-medium transition-colors duration-200 flex items-center gap-2 px-3 py-2 rounded-lg ${
                        activeTool === tool ? 'bg-blue-50 text-blue-700' : 'text-gray-600 hover:text-gray-900 hover:bg-gray-50'
                    }`}
                >
                    <i className={`${icon} text-base`}></i>
                    {label}
                </button>
            );

            return (
                <div className="min-h-screen bg-gray-50 flex flex-col">
                    {/* Top Navigation Bar */}
                    <header className="bg-white border-b border-gray-200 sticky top-0 z-40">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex justify-between h-16 items-center">
                                {/* Logo */}
                                <div className="flex items-center gap-3 cursor-pointer" onClick={() => setActiveTool('dashboard')}>
                                    <div className="w-9 h-9 bg-blue-800 rounded-lg text-white flex items-center justify-center font-bold text-lg shadow-sm">
                                        RB
                                    </div>
                                    <span className="font-bold text-xl text-gray-900 tracking-tight">Remote Business Partner</span>
                                </div>

                                {/* Desktop Navigation */}
                                <nav className="hidden xl:flex items-center gap-2">
                                    <NavButton tool="dashboard" icon="fas fa-th-large" label="Dashboard" />
                                    <div className="h-6 w-px bg-gray-200 mx-2"></div>
                                    <NavButton tool="condition-report" icon="fas fa-file-alt" label="Entry Report" />
                                    <NavButton tool="routine-inspection" icon="fas fa-clipboard-check" label="Routine" />
                                    <NavButton tool="exit-inspection" icon="fas fa-sign-out-alt" label="Exit" />
                                    <div className="h-6 w-px bg-gray-200 mx-2"></div>
                                    <NavButton tool="clients" icon="fas fa-building" label="Properties" />
                                    <NavButton tool="settings" icon="fas fa-cog" label="Settings" />
                                </nav>

                                {/* Mobile Menu Toggle */}
                                <div className="flex items-center gap-4 xl:hidden">
                                    <button 
                                        className="p-2 text-gray-600 rounded-lg hover:bg-gray-100"
                                        onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
                                    >
                                        <i className={`fas ${isMobileMenuOpen ? 'fa-times' : 'fa-bars'} text-xl`}></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* Mobile Menu */}
                        {isMobileMenuOpen && (
                            <div className="xl:hidden bg-white border-t border-gray-200 px-4 pt-2 pb-4 shadow-lg absolute w-full z-50">
                                <div className="flex flex-col gap-2">
                                    <NavButton tool="dashboard" icon="fas fa-th-large" label="Dashboard" />
                                    <NavButton tool="condition-report" icon="fas fa-file-alt" label="Entry Report" />
                                    <NavButton tool="routine-inspection" icon="fas fa-clipboard-check" label="Routine Inspection" />
                                    <NavButton tool="exit-inspection" icon="fas fa-sign-out-alt" label="Exit Inspection" />
                                    <NavButton tool="clients" icon="fas fa-building" label="Properties" />
                                    <NavButton tool="settings" icon="fas fa-cog" label="Settings" />
                                </div>
                            </div>
                        )}
                    </header>

                    {/* Main Content Area */}
                    <main className="flex-1">
                        {activeTool === 'dashboard' ? (
                            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 animate-in">
                                <div className="mb-10 text-center md:text-left">
                                    <h1 className="text-3xl font-bold text-gray-900 mb-2">Welcome Back, Admin</h1>
                                    <p className="text-gray-500">Select a tool below to get started with your property management tasks.</p>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    <div 
                                        onClick={() => setActiveTool('condition-report')}
                                        className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-blue-300 transition-all cursor-pointer group"
                                    >
                                        <div className="w-12 h-12 bg-blue-50 text-blue-600 rounded-lg flex items-center justify-center mb-4 group-hover:bg-blue-100 transition-colors">
                                            <i className="fas fa-file-alt text-2xl"></i>
                                        </div>
                                        <h3 className="text-lg font-bold text-gray-900 mb-2">Entry Condition Report</h3>
                                        <p className="text-gray-500 text-sm mb-6">
                                            Create comprehensive entry condition reports with photos and AI assistance.
                                        </p>
                                        <div className="flex items-center text-blue-600 text-sm font-semibold group-hover:translate-x-1 transition-transform">
                                            Start Report <i className="fas fa-arrow-right ml-2"></i>
                                        </div>
                                    </div>

                                    <div 
                                        onClick={() => setActiveTool('routine-inspection')}
                                        className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-green-300 transition-all cursor-pointer group"
                                    >
                                        <div className="w-12 h-12 bg-green-50 text-green-600 rounded-lg flex items-center justify-center mb-4 group-hover:bg-green-100 transition-colors">
                                            <i className="fas fa-clipboard-check text-2xl"></i>
                                        </div>
                                        <h3 className="text-lg font-bold text-gray-900 mb-2">Routine Inspection</h3>
                                        <p className="text-gray-500 text-sm mb-6">
                                            Conduct periodic routine inspections with streamlined reporting.
                                        </p>
                                        <div className="flex items-center text-green-600 text-sm font-semibold group-hover:translate-x-1 transition-transform">
                                            Start Inspection <i className="fas fa-arrow-right ml-2"></i>
                                        </div>
                                    </div>

                                    <div 
                                        onClick={() => setActiveTool('exit-inspection')}
                                        className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-red-300 transition-all cursor-pointer group"
                                    >
                                        <div className="w-12 h-12 bg-red-50 text-red-600 rounded-lg flex items-center justify-center mb-4 group-hover:bg-red-100 transition-colors">
                                            <i className="fas fa-sign-out-alt text-2xl"></i>
                                        </div>
                                        <h3 className="text-lg font-bold text-gray-900 mb-2">Exit Inspection</h3>
                                        <p className="text-gray-500 text-sm mb-6">
                                            Document property condition at tenant exit with detailed reporting.
                                        </p>
                                        <div className="flex items-center text-red-600 text-sm font-semibold group-hover:translate-x-1 transition-transform">
                                            Start Inspection <i className="fas fa-arrow-right ml-2"></i>
                                        </div>
                                    </div>

                                    <div 
                                        onClick={() => setActiveTool('clients')}
                                        className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-purple-300 transition-all cursor-pointer group"
                                    >
                                        <div className="w-12 h-12 bg-purple-50 text-purple-600 rounded-lg flex items-center justify-center mb-4 group-hover:bg-purple-100 transition-colors">
                                            <i className="fas fa-building text-2xl"></i>
                                        </div>
                                        <h3 className="text-lg font-bold text-gray-900 mb-2">Property Management</h3>
                                        <p className="text-gray-500 text-sm mb-6">
                                            Manage your property portfolio and client information.
                                        </p>
                                        <div className="flex items-center text-purple-600 text-sm font-semibold group-hover:translate-x-1 transition-transform">
                                            Manage Properties <i className="fas fa-arrow-right ml-2"></i>
                                        </div>
                                    </div>

                                    <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 opacity-75">
                                        <div className="w-12 h-12 bg-orange-50 text-orange-600 rounded-lg flex items-center justify-center mb-4">
                                            <i className="fas fa-file-invoice text-2xl"></i>
                                        </div>
                                        <h3 className="text-lg font-bold text-gray-900 mb-2">Proposals</h3>
                                        <p className="text-gray-500 text-sm mb-6">
                                            Generate professional proposals for clients. (Coming Soon)
                                        </p>
                                        <div className="flex items-center text-orange-600 text-sm font-semibold opacity-50">
                                            Coming Soon
                                        </div>
                                    </div>

                                    <div 
                                        onClick={() => setActiveTool('settings')}
                                        className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-gray-400 transition-all cursor-pointer group"
                                    >
                                        <div className="w-12 h-12 bg-gray-50 text-gray-600 rounded-lg flex items-center justify-center mb-4 group-hover:bg-gray-100 transition-colors">
                                            <i className="fas fa-cog text-2xl"></i>
                                        </div>
                                        <h3 className="text-lg font-bold text-gray-900 mb-2">Settings</h3>
                                        <p className="text-gray-500 text-sm mb-6">
                                            Configure your company information and preferences.
                                        </p>
                                        <div className="flex items-center text-gray-600 text-sm font-semibold group-hover:translate-x-1 transition-transform">
                                            Configure <i className="fas fa-arrow-right ml-2"></i>
                                        </div>
                                    </div>
                                </div>

                                <div className="mt-10 bg-blue-50 rounded-xl p-6 border border-blue-200">
                                    <h2 className="text-lg font-bold text-blue-900 mb-2">
                                        <i className="fas fa-info-circle mr-2"></i>
                                        AI-Powered Features
                                    </h2>
                                    <p className="text-blue-700">
                                        This platform uses Google Gemini AI to analyze property photos and generate detailed condition descriptions. 
                                        Simply upload photos during inspections and let AI assist with identifying defects and creating professional reports.
                                    </p>
                                </div>
                            </div>
                        ) : (
                            getActiveComponent()
                        )}
                    </main>
                </div>
            );
        };
        
        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>